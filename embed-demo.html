<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3speak Player Embedding Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a1a;
            color: #fff;
            padding: 40px 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 40px;
        }
        
        .demo-section {
            background: #2a2a2a;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 40px;
        }
        
        .demo-section h2 {
            margin-bottom: 20px;
            color: #4a9eff;
        }
        
        .demo-section p {
            color: #ccc;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .video-wrapper {
            background: #000;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .responsive-embed {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
        }
        
        .responsive-embed iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .code-block {
            background: #1a1a1a;
            border: 1px solid #444;
            border-radius: 6px;
            padding: 15px;
            margin-top: 15px;
            overflow-x: auto;
        }
        
        .code-block code {
            color: #4af;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            white-space: pre;
        }
        
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .comparison-item h3 {
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        @media (max-width: 768px) {
            .comparison {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.8em;
            }
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .feature {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 6px;
            border-left: 3px solid #4a9eff;
        }
        
        .feature strong {
            color: #4a9eff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé• 3speak Player Embedding Demo</h1>
        <p class="subtitle">Examples of how to embed videos from play.3speak.tv</p>

        <!-- Standard Embed -->
        <div class="demo-section">
            <h2>1. Standard Embed (iframe mode)</h2>
            <p>This is the recommended way to embed videos. The <code>&mode=iframe</code> parameter hides the header and info panel for a clean, embeddable experience.</p>
            
            <div class="video-wrapper">
                <iframe 
                    src="https://play.3speak.tv/watch?v=meno/1czchhmr&mode=iframe" 
                    width="100%" 
                    height="480"
                    frameborder="0"
                    allowfullscreen
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    title="3speak Video Player">
                </iframe>
            </div>
            
            <div class="code-block">
                <code>&lt;iframe 
  src="https://play.3speak.tv/watch?v=meno/1czchhmr&mode=iframe" 
  width="854" 
  height="480"
  frameborder="0"
  allowfullscreen&gt;
&lt;/iframe&gt;</code>
            </div>
        </div>

        <!-- Responsive Embed -->
        <div class="demo-section">
            <h2>2. Responsive Embed (16:9 aspect ratio)</h2>
            <p>This maintains a 16:9 aspect ratio and adapts to any screen size.</p>
            
            <div class="responsive-embed">
                <iframe 
                    src="https://play.3speak.tv/watch?v=meno/1czchhmr&mode=iframe" 
                    frameborder="0"
                    allowfullscreen
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture">
                </iframe>
            </div>
            
            <div class="code-block">
                <code>&lt;div style="position: relative; padding-bottom: 56.25%; height: 0;"&gt;
  &lt;iframe 
    src="https://play.3speak.tv/watch?v=meno/1czchhmr&mode=iframe" 
    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
    frameborder="0"
    allowfullscreen&gt;
  &lt;/iframe&gt;
&lt;/div&gt;</code>
            </div>
        </div>

        <!-- Comparison -->
        <div class="demo-section">
            <h2>3. With vs Without Iframe Mode</h2>
            <p>Compare the difference between full player page and minimal embed mode.</p>
            
            <div class="comparison">
                <div class="comparison-item">
                    <h3>Without iframe mode (full UI)</h3>
                    <div class="video-wrapper">
                        <iframe 
                            src="https://play.3speak.tv/watch?v=meno/1czchhmr" 
                            width="100%" 
                            height="400"
                            frameborder="0"
                            allowfullscreen>
                        </iframe>
                    </div>
                    <div class="code-block">
                        <code>?v=meno/1czchhmr</code>
                    </div>
                </div>
                
                <div class="comparison-item">
                    <h3>With iframe mode (minimal UI)</h3>
                    <div class="video-wrapper">
                        <iframe 
                            src="https://play.3speak.tv/watch?v=meno/1czchhmr&mode=iframe" 
                            width="100%" 
                            height="400"
                            frameborder="0"
                            allowfullscreen>
                        </iframe>
                    </div>
                    <div class="code-block">
                        <code>?v=meno/1czchhmr&mode=iframe</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Different Sizes -->
        <div class="demo-section">
            <h2>4. Different Sizes</h2>
            <p>You can customize the size to fit your layout.</p>
            
            <h3 style="margin-top: 20px;">Small (640x360)</h3>
            <div class="video-wrapper" style="max-width: 640px;">
                <iframe 
                    src="https://play.3speak.tv/watch?v=meno/1czchhmr&mode=iframe" 
                    width="640" 
                    height="360"
                    frameborder="0"
                    allowfullscreen>
                </iframe>
            </div>
            
            <h3 style="margin-top: 30px;">Medium (854x480) - Recommended</h3>
            <div class="video-wrapper" style="max-width: 854px;">
                <iframe 
                    src="https://play.3speak.tv/watch?v=meno/1czchhmr&mode=iframe" 
                    width="854" 
                    height="480"
                    frameborder="0"
                    allowfullscreen>
                </iframe>
            </div>
        </div>

        <!-- Features -->
        <div class="demo-section">
            <h2>5. Player Features</h2>
            <div class="features">
                <div class="feature">
                    <strong>üé¨ HLS Streaming</strong><br>
                    Adaptive quality streaming
                </div>
                <div class="feature">
                    <strong>‚öôÔ∏è Quality Selector</strong><br>
                    Manual quality override
                </div>
                <div class="feature">
                    <strong>üîÑ Auto Fallback</strong><br>
                    Multiple IPFS gateways
                </div>
                <div class="feature">
                    <strong>üì± Responsive</strong><br>
                    Mobile-friendly design
                </div>
                <div class="feature">
                    <strong>‚èØÔ∏è Full Controls</strong><br>
                    Play, pause, seek, volume
                </div>
                <div class="feature">
                    <strong>‚ö° Speed Control</strong><br>
                    0.5x to 2x playback
                </div>
                <div class="feature">
                    <strong>üñºÔ∏è Thumbnails</strong><br>
                    Poster image support
                </div>
                <div class="feature">
                    <strong>üìä View Tracking</strong><br>
                    Automatic view counter
                </div>
            </div>
        </div>

        <!-- Layout Modes Guide -->
        <div class="demo-section">
            <h2>6. üìê Layout Modes - Choosing the Right Container</h2>
            <p>The 3speak player supports three layout modes to handle different embedding scenarios. Choose the one that fits your use case:</p>

            <h3>Quick Comparison Table</h3>
            <div style="background: #1a1a1a; border-radius: 8px; padding: 20px; margin: 20px 0; overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; color: #ccc;">
                    <tr style="border-bottom: 1px solid #444;">
                        <th style="padding: 12px; text-align: left; color: #4a9eff;">Mode</th>
                        <th style="padding: 12px; text-align: left; color: #4a9eff;">Aspect Ratio</th>
                        <th style="padding: 12px; text-align: left; color: #4a9eff;">Best For</th>
                        <th style="padding: 12px; text-align: left; color: #4a9eff;">Key Feature</th>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px; background: #252525;"><code style="color: #4af;">layout=mobile</code></td>
                        <td style="padding: 12px; background: #252525;">3:4 (tall)</td>
                        <td style="padding: 12px; background: #252525;">Mobile apps, social feeds</td>
                        <td style="padding: 12px; background: #252525;">Universal container for all videos</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px;"><code style="color: #4af;">layout=square</code></td>
                        <td style="padding: 12px;">1:1 (square)</td>
                        <td style="padding: 12px;">Grid layouts, thumbnails</td>
                        <td style="padding: 12px;">Maximum compatibility</td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; background: #252525;"><code style="color: #4af;">layout=desktop</code></td>
                        <td style="padding: 12px; background: #252525;">16:9 (YouTube-style)</td>
                        <td style="padding: 12px; background: #252525;">Web embeds, blog posts</td>
                        <td style="padding: 12px; background: #252525;">Professional letterboxing</td>
                    </tr>
                </table>
            </div>

            <h3 style="margin-top: 30px;">1. Desktop Layout - YouTube-Style (Default)</h3>
            <p>The <code>&layout=desktop</code> mode maintains a strict 16:9 aspect ratio like YouTube. All videos (vertical, horizontal, or square) display with perfect letterboxing. <strong>This is perfect for web embeds.</strong></p>
            
            <div class="comparison">
                <div class="comparison-item">
                    <h3>Vertical Video (with letterboxing)</h3>
                    <div class="video-wrapper">
                        <iframe 
                            src="https://play.3speak.tv/embed?v=vempromundo/hkh2vzzf&mode=iframe&layout=desktop" 
                            width="100%" 
                            height="450"
                            frameborder="0"
                            allowfullscreen>
                        </iframe>
                    </div>
                    <div class="code-block">
                        <code>&layout=desktop
/* All vertical videos get black bars on sides */</code>
                    </div>
                </div>
                
                <div class="comparison-item">
                    <h3>Horizontal Video (no letterboxing needed)</h3>
                    <div class="video-wrapper">
                        <iframe 
                            src="https://play.3speak.tv/embed?v=meno/1czchhmr&mode=iframe&layout=desktop" 
                            width="100%" 
                            height="450"
                            frameborder="0"
                            allowfullscreen>
                        </iframe>
                    </div>
                    <div class="code-block">
                        <code>&layout=desktop
/* Horizontal videos fill the container naturally */</code>
                    </div>
                </div>
            </div>

            <h3 style="margin-top: 30px;">2. Mobile Layout - Tall Container (3:4)</h3>
            <p><strong>Recommended for mobile apps!</strong> The <code>&layout=mobile</code> parameter creates a tall 3:4 container that works beautifully for both vertical AND horizontal videos without any scrollbars.</p>
            
            <div class="comparison">
                <div class="comparison-item">
                    <h3>Vertical Video</h3>
                    <div class="video-wrapper" style="max-width: 350px; margin: 0 auto;">
                        <iframe 
                            src="https://play.3speak.tv/embed?v=vempromundo/hkh2vzzf&mode=iframe&layout=mobile" 
                            width="100%" 
                            height="600"
                            frameborder="0"
                            allowfullscreen>
                        </iframe>
                    </div>
                    <div class="code-block">
                        <code>/* Perfect fit for vertical videos */
&layout=mobile
height="600"</code>
                    </div>
                </div>
                
                <div class="comparison-item">
                    <h3>Horizontal Video</h3>
                    <div class="video-wrapper" style="max-width: 350px; margin: 0 auto;">
                        <iframe 
                            src="https://play.3speak.tv/embed?v=meno/mtbb87lv&mode=iframe&layout=mobile" 
                            width="100%" 
                            height="600"
                            frameborder="0"
                            allowfullscreen>
                        </iframe>
                    </div>
                    <div class="code-block">
                        <code>/* Horizontal gets black bars above/below */
&layout=mobile
height="600"</code>
                    </div>
                </div>
            </div>

            <h3 style="margin-top: 30px;">3. Square Layout - 1:1 Container</h3>
            <p>For maximum universal compatibility, use <code>&layout=square</code> for a 1:1 square container. Works for any video orientation.</p>
            
            <div class="video-wrapper" style="max-width: 400px; margin: 20px auto;">
                <iframe 
                    src="https://play.3speak.tv/embed?v=vempromundo/hkh2vzzf&mode=iframe&layout=square" 
                    width="100%" 
                    height="400"
                    frameborder="0"
                    allowfullscreen>
                </iframe>
            </div>
            
            <div class="code-block">
                <code>&lt;iframe 
  src="https://play.3speak.tv/embed?v=author/permlink&mode=iframe&layout=square" 
  width="350" 
  height="350"
  frameborder="0"
  allowfullscreen&gt;
&lt;/iframe&gt;</code>
            </div>

            <h3 style="margin-top: 30px;">‚ú® Automatic Orientation Detection (Web Apps)</h3>
            <p>For web applications, you don't need to manually detect video orientation. Just listen for the player's ready message and let it tell you!</p>
            
            <div class="code-block">
                <code>// ONE TIME setup - works for ALL videos on your page
window.addEventListener('message', function(event) {
    if (event.data.type === '3speak-player-ready') {
        const iframe = event.source.frameElement;
        
        // Player tells you video dimensions and orientation!
        console.log('Video info:', {
            isVertical: event.data.isVertical,  // true/false
            width: event.data.width,             // e.g., 720
            height: event.data.height,           // e.g., 1280
            aspectRatio: event.data.aspectRatio  // e.g., 0.5625
        });
        
        // Adjust your iframe or container based on orientation
        if (event.data.isVertical) {
            iframe.height = '800px';
            iframe.maxWidth = '450px';
        } else {
            iframe.height = '450px';
            iframe.maxWidth = '800px';
        }
    }
});

// Embed videos normally - no special code per video!
function embedVideo(author, permlink) {
    const iframe = document.createElement('iframe');
    iframe.src = `https://play.3speak.tv/embed?v=${author}/${permlink}&mode=iframe`;
    iframe.width = '100%';
    iframe.height = '600'; // Default, will auto-adjust
    iframe.frameBorder = '0';
    iframe.allowFullscreen = true;
    document.body.appendChild(iframe);
}</code>
            </div>

            <h3 style="margin-top: 30px;">React/Next.js Component</h3>
            <div class="code-block">
                <code>import { useEffect, useRef, useState } from 'react';

const ThreeSpeakPlayer = ({ author, permlink }) => {
    const iframeRef = useRef(null);
    const [isVertical, setIsVertical] = useState(false);
    
    useEffect(() => {
        const handleMessage = (event) => {
            if (event.data.type === '3speak-player-ready' && 
                event.source === iframeRef.current?.contentWindow) {
                setIsVertical(event.data.isVertical);
            }
        };
        
        window.addEventListener('message', handleMessage);
        return () => window.removeEventListener('message', handleMessage);
    }, []);
    
    const height = isVertical ? '800px' : '450px';
    const maxWidth = isVertical ? '450px' : '800px';
    
    return (
        &lt;div style={{ maxWidth, margin: '0 auto' }}&gt;
            &lt;iframe
                ref={iframeRef}
                src={`https://play.3speak.tv/embed?v=${author}/${permlink}&mode=iframe`}
                width="100%"
                height={height}
                style={{ border: 'none', borderRadius: '8px' }}
                allowFullScreen
            /&gt;
        &lt;/div&gt;
    );
};

// Usage
&lt;ThreeSpeakPlayer author="vempromundo" permlink="hkh2vzzf" /&gt;</code>
            </div>
        </div>

        <!-- Mobile App Integration -->
        <div class="demo-section">
            <h2>7. üì± Mobile App Integration - No Scrollbars</h2>
            <p><strong>Problem:</strong> Mobile apps can't always adapt iframe sizes dynamically. <strong>Solution:</strong> Use the <code>&layout=mobile</code> parameter for universal containers that work with any video orientation!</p>
            
            <div style="background: #2d5a27; border-radius: 8px; padding: 20px; margin: 20px 0; border-left: 4px solid #4caf50;">
                <strong style="color: #a5d6a7;">‚ú® NEW: Layout Modes for Universal Mobile Compatibility!</strong><br>
                If your mobile app can't dynamically resize iframes, use our layout parameter to create a universal container that works for ALL video orientations without scrollbars!
            </div>

            <h3>Available Layout Modes</h3>
            <div class="features" style="margin-bottom: 30px;">
                <div class="feature">
                    <strong style="color: #4a9eff;">üì± layout=mobile</strong><br>
                    Tall 3:4 container optimized for mobile<br>
                    <code>Perfect for all orientations</code>
                </div>
                <div class="feature">
                    <strong style="color: #4a9eff;">‚¨ú layout=square</strong><br>
                    Square 1:1 container<br>
                    <code>Universal compatibility</code>
                </div>
                <div class="feature">
                    <strong style="color: #4a9eff;">üñ•Ô∏è layout=desktop</strong><br>
                    Flexible responsive container<br>
                    <code>Default adaptive behavior</code>
                </div>
            </div>

            <h3>1. Mobile Layout (Recommended for Apps)</h3>
            <p>The <code>&layout=mobile</code> parameter creates a 3:4 tall container perfect for mobile apps. Works beautifully for both vertical AND horizontal videos without any scrollbars!</p>
            
            <div class="comparison">
                <div class="comparison-item">
                    <h3>Vertical Video with Mobile Layout</h3>
                    <div class="video-wrapper" style="max-width: 350px; margin: 0 auto;">
                        <iframe 
                            src="https://play.3speak.tv/embed?v=vempromundo/hkh2vzzf&mode=iframe&layout=mobile" 
                            width="100%" 
                            height="600"
                            frameborder="0"
                            allowfullscreen>
                        </iframe>
                    </div>
                    <div class="code-block">
                        <code>/* Perfect for vertical videos */
&layout=mobile</code>
                    </div>
                </div>
                
                <div class="comparison-item">
                    <h3>Horizontal Video with Mobile Layout</h3>
                    <div class="video-wrapper" style="max-width: 350px; margin: 0 auto;">
                        <iframe 
                            src="https://play.3speak.tv/embed?v=meno/mtbb87lv&mode=iframe&layout=mobile" 
                            width="100%" 
                            height="600"
                            frameborder="0"
                            allowfullscreen>
                        </iframe>
                    </div>
                    <div class="code-block">
                        <code>/* Also works for horizontal - letterboxed */
&layout=mobile</code>
                    </div>
                </div>
            </div>

            <h3>2. Square Layout (Maximum Compatibility)</h3>
            <p>For apps that need a completely universal container, <code>&layout=square</code> creates a 1:1 square that works for any video orientation.</p>
            
            <div class="video-wrapper" style="max-width: 400px; margin: 20px auto;">
                <iframe 
                    src="https://play.3speak.tv/embed?v=vempromundo/hkh2vzzf&mode=iframe&layout=square" 
                    width="100%" 
                    height="400"
                    frameborder="0"
                    allowfullscreen>
                </iframe>
            </div>
            
            <div class="code-block">
                <code>&lt;iframe 
  src="https://play.3speak.tv/embed?v=author/permlink&mode=iframe&layout=square" 
  width="350" 
  height="350"
  frameborder="0"
  allowfullscreen&gt;
&lt;/iframe&gt;</code>
            </div>

            <h3>3. iOS Swift Integration Example</h3>
            <div class="code-block">
                <code>import UIKit
import WebKit

class VideoPlayerViewController: UIViewController {
    var webView: WKWebView!
    let author: String
    let permlink: String
    
    init(author: String, permlink: String) {
        self.author = author
        self.permlink = permlink
        super.init(nibName: nil, bundle: nil)
    }
    
    override func viewDidLoad() {
        super.viewDidLoad()
        
        // Create WKWebView
        webView = WKWebView(frame: self.view.bounds)
        webView.autoresizingMask = [.flexibleWidth, .flexibleHeight]
        webView.scrollView.isScrollEnabled = false // No scrollbars!
        view.addSubview(webView)
        
        // üéØ Use layout=mobile for universal compatibility!
        let videoURL = "https://play.3speak.tv/embed?v=\(author)/\(permlink)&mode=iframe&layout=mobile"
        
        if let url = URL(string: videoURL) {
            let request = URLRequest(url: url)
            webView.load(request)
        }
    }
}

// Usage - Same code for vertical AND horizontal videos!
let verticalVideo = VideoPlayerViewController(author: "vempromundo", permlink: "hkh2vzzf")
let horizontalVideo = VideoPlayerViewController(author: "meno", permlink: "1czchhmr")</code>
            </div>

            <h3>4. Android Kotlin Integration Example</h3>
            <div class="code-block">
                <code>import android.os.Bundle
import android.webkit.WebView
import android.webkit.WebViewClient
import androidx.appcompat.app.AppCompatActivity

class VideoPlayerActivity : AppCompatActivity() {
    private lateinit var webView: WebView
    
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_video_player)
        
        val author = intent.getStringExtra("author") ?: ""
        val permlink = intent.getStringExtra("permlink") ?: ""
        
        webView = findViewById(R.id.webView)
        webView.settings.javaScriptEnabled = true
        webView.settings.mediaPlaybackRequiresUserGesture = false
        webView.webViewClient = WebViewClient()
        
        // üéØ Use layout=mobile - works for all orientations!
        val videoUrl = "https://play.3speak.tv/embed?v=$author/$permlink&mode=iframe&layout=mobile"
        webView.loadUrl(videoUrl)
    }
}

// XML Layout (activity_video_player.xml)
/*
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#000000"&gt;
    
    &lt;WebView
        android:id="@+id/webView"
        android:layout_width="match_parent"
        android:layout_height="match_parent" /&gt;
&lt;/FrameLayout&gt;
*/</code>
            </div>

            <h3>5. React Native Integration Example</h3>
            <div class="code-block">
                <code>import React from 'react';
import { View, StyleSheet } from 'react-native';
import { WebView } from 'react-native-webview';

const ThreeSpeakPlayer = ({ author, permlink, style }) => {
  // üéØ Use layout=mobile for universal compatibility
  const videoUrl = `https://play.3speak.tv/embed?v=${author}/${permlink}&mode=iframe&layout=mobile`;
  
  return (
    &lt;View style={[styles.container, style]}&gt;
      &lt;WebView
        source={{ uri: videoUrl }}
        allowsFullscreenVideo={true}
        mediaPlaybackRequiresUserAction={false}
        javaScriptEnabled={true}
        scrollEnabled={false}
        style={styles.webview}
      /&gt;
    &lt;/View&gt;
  );
};

const styles = StyleSheet.create({
  container: {
    backgroundColor: '#000',
    aspectRatio: 3/4, // Match mobile layout ratio
  },
  webview: {
    backgroundColor: 'transparent',
  }
});

// Usage - Same component for ALL videos!
export default function App() {
  return (
    &lt;View style={{ flex: 1 }}&gt;
      &lt;ThreeSpeakPlayer author="vempromundo" permlink="hkh2vzzf" /&gt;
      &lt;ThreeSpeakPlayer author="meno" permlink="1czchhmr" /&gt;
    &lt;/View&gt;
  );
}</code>
            </div>

            <h3>6. Flutter Integration Example</h3>
            <div class="code-block">
                <code>import 'package:flutter/material.dart';
import 'package:webview_flutter/webview_flutter.dart';

class ThreeSpeakPlayer extends StatefulWidget {
  final String author;
  final String permlink;
  
  const ThreeSpeakPlayer({
    Key? key,
    required this.author,
    required this.permlink,
  }) : super(key: key);
  
  @override
  State&lt;ThreeSpeakPlayer&gt; createState() => _ThreeSpeakPlayerState();
}

class _ThreeSpeakPlayerState extends State&lt;ThreeSpeakPlayer&gt; {
  late final WebViewController _controller;
  
  @override
  void initState() {
    super.initState();
    
    // üéØ Use layout=mobile for universal compatibility
    final videoUrl = 'https://play.3speak.tv/embed?v=${widget.author}/${widget.permlink}&mode=iframe&layout=mobile';
    
    _controller = WebViewController()
      ..setJavaScriptMode(JavaScriptMode.unrestricted)
      ..loadRequest(Uri.parse(videoUrl));
  }
  
  @override
  Widget build(BuildContext context) {
    return Container(
      color: Colors.black,
      child: AspectRatio(
        aspectRatio: 3 / 4, // Match mobile layout ratio
        child: WebViewWidget(controller: _controller),
      ),
    );
  }
}

// Usage in your feed
ListView.builder(
  itemCount: videos.length,
  itemBuilder: (context, index) {
    final video = videos[index];
    return ThreeSpeakPlayer(
      author: video.author,
      permlink: video.permlink,
    );
  },
)</code>
            </div>

            <div style="background: #2d5a27; border-radius: 8px; padding: 20px; margin: 20px 0; border-left: 4px solid #4caf50;">
                <strong style="color: #a5d6a7;">üéâ Mobile App Integration - Super Simple!</strong><br>
                <strong>Benefits of layout=mobile parameter:</strong><br>
                ‚Ä¢ ‚úÖ <strong>One container for all videos</strong> - No orientation detection needed<br>
                ‚Ä¢ ‚úÖ <strong>No scrollbars ever</strong> - Perfect letterboxing for all orientations<br>
                ‚Ä¢ ‚úÖ <strong>Copy-paste integration</strong> - Same code for iOS, Android, React Native, Flutter<br>
                ‚Ä¢ ‚úÖ <strong>Production-ready</strong> - Works immediately without database changes<br>
                ‚Ä¢ ‚úÖ <strong>Mobile-optimized</strong> - 3:4 aspect ratio ideal for phone screens<br>
                <br>
                <strong>Just add <code>&layout=mobile</code> to your iframe URL and you're done!</strong>
            </div>

            <h3>Quick Reference - All Layout Modes</h3>
            <div class="code-block">
                <code>// MOBILE LAYOUT - Tall container (3:4 aspect ratio) - RECOMMENDED FOR APPS
https://play.3speak.tv/embed?v=author/permlink&mode=iframe&layout=mobile
// Perfect for: iOS, Android, React Native, Flutter apps

// SQUARE LAYOUT - Universal square container (1:1)
https://play.3speak.tv/embed?v=author/permlink&mode=iframe&layout=square
// Perfect for: Social media grids, thumbnails, ultra-simple layouts

// DESKTOP LAYOUT - Flexible responsive (default behavior)
https://play.3speak.tv/embed?v=author/permlink&mode=iframe&layout=desktop
// Perfect for: Web apps that can dynamically resize iframes

// NO LAYOUT PARAMETER - Same as desktop (fluid responsive)
https://play.3speak.tv/embed?v=author/permlink&mode=iframe
// Uses default fluid mode with PostMessage API for dimension communication</code>
            </div>

            <h3 style="margin-top: 30px;">üö´ Disabling Scrollbars - The <code>noscroll</code> Parameter</h3>
            <div style="background: #1a3a5c; border-radius: 8px; padding: 20px; margin: 20px 0; border-left: 4px solid #4a9eff;">
                <strong style="color: #87ceeb;">Problem:</strong> Some embedding contexts (like constrained layouts or mobile apps) can show unwanted scrollbars inside the iframe.<br><br>
                <strong style="color: #87ceeb;">Solution:</strong> Add <code>&noscroll=1</code> to completely disable all scrollbars within the player iframe.
            </div>

            <div class="code-block">
                <code>// Standard embed - may show scrollbars in tight layouts
https://play.3speak.tv/embed?v=author/permlink&mode=iframe&layout=mobile

// No-scroll mode - guaranteed zero scrollbars
https://play.3speak.tv/embed?v=author/permlink&mode=iframe&layout=mobile&noscroll=1

// Works with any layout mode
https://play.3speak.tv/embed?v=author/permlink&mode=iframe&noscroll=1
https://play.3speak.tv/embed?v=author/permlink&mode=iframe&layout=square&noscroll=1</code>
            </div>

            <h3 style="margin-top: 20px;">When to Use <code>noscroll</code></h3>
            <div class="features" style="margin-bottom: 30px;">
                <div class="feature">
                    <strong style="color: #4a9eff;">‚úÖ Mobile Apps</strong><br>
                    Eliminate scrollbars in constrained WebView containers
                </div>
                <div class="feature">
                    <strong style="color: #4a9eff;">‚úÖ Fixed Layouts</strong><br>
                    When your iframe has fixed dimensions
                </div>
                <div class="feature">
                    <strong style="color: #4a9eff;">‚úÖ Embedded Widgets</strong><br>
                    Clean look in sidebars or cards
                </div>
                <div class="feature">
                    <strong style="color: #4a9eff;">‚úÖ Design Systems</strong><br>
                    Maintain strict visual consistency
                </div>
            </div>

            <div style="background: #2d5a27; border-radius: 8px; padding: 20px; margin: 20px 0; border-left: 4px solid #4caf50;">
                <strong style="color: #a5d6a7;">üí° Pro Tip:</strong> Combine <code>layout=mobile</code> + <code>noscroll=1</code> for the ultimate mobile app experience:<br>
                <code style="color: #fff; background: #1a1a1a; padding: 5px 10px; border-radius: 4px; display: inline-block; margin-top: 10px;">https://play.3speak.tv/embed?v=author/permlink&mode=iframe&layout=mobile&noscroll=1</code><br><br>
                This gives you a perfectly centered video in a tall container with absolutely zero scrollbars!
            </div>
        </div>

        <!-- External Controls Demo -->
        <div class="demo-section">
            <h2>8. üéÆ External Controls via postMessage API</h2>
            <p>Control the player from outside the iframe using the postMessage API. Use <code>&controls=0</code> to hide the built-in controls and provide your own UI.</p>

            <div style="display: flex; gap: 30px; align-items: flex-start; flex-wrap: wrap;">
                <div style="max-width: 300px; flex-shrink: 0;">
                    <div style="aspect-ratio: 3/4; background: #000; border-radius: 8px; overflow: hidden;">
                        <iframe
                            id="controlled-player"
                            src="https://play.3speak.tv/embed?v=vempromundo/hkh2vzzf&mode=iframe&layout=mobile&controls=0"
                            width="100%"
                            height="100%"
                            frameborder="0"
                            allow="autoplay; fullscreen"
                            allowfullscreen>
                        </iframe>
                    </div>
                </div>

                <div style="flex: 1; min-width: 250px;">
                    <h3 style="margin-bottom: 15px;">External Controls</h3>

                    <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                        <button onclick="sendCommand('seekBackward')" style="padding: 12px 16px; font-size: 16px; cursor: pointer; background: #666; color: white; border: none; border-radius: 6px;" title="Back 10s">
                            ‚è™ 10s
                        </button>
                        <button id="play-pause-btn" onclick="togglePlayPause()" style="padding: 12px 24px; font-size: 16px; cursor: pointer; background: #4a9eff; color: white; border: none; border-radius: 6px; min-width: 100px;">
                            ‚ñ∂ Play
                        </button>
                        <button onclick="sendCommand('seekForward')" style="padding: 12px 16px; font-size: 16px; cursor: pointer; background: #666; color: white; border: none; border-radius: 6px;" title="Forward 10s">
                            10s ‚è©
                        </button>
                        <button onclick="sendCommand('toggleFullscreen')" style="padding: 12px 24px; font-size: 16px; cursor: pointer; background: #4a9eff; color: white; border: none; border-radius: 6px;">
                            ‚õ∂ Fullscreen
                        </button>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 12px; color: #888;">
                            <span id="time-current">0:00</span>
                            <span id="time-duration">0:00</span>
                        </div>
                        <div id="progress-bar" style="position: relative; height: 6px; background: #444; border-radius: 3px; cursor: pointer; width: 100%; max-width: 300px;">
                            <div id="progress-fill" style="position: absolute; top: 0; left: 0; height: 100%; background: #4a9eff; border-radius: 3px; width: 0%; pointer-events: none;"></div>
                            <div id="progress-handle" style="position: absolute; top: 50%; left: 0%; transform: translate(-50%, -50%); width: 14px; height: 14px; background: #fff; border-radius: 50%; box-shadow: 0 1px 4px rgba(0,0,0,0.4); cursor: grab;"></div>
                        </div>
                    </div>

                    <div style="margin-bottom: 20px; display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                        <label style="white-space: nowrap; color: #ccc;">Volume: <span id="volume-display">100%</span></label>
                        <input
                            type="range"
                            id="volume-slider"
                            min="0"
                            max="100"
                            value="100"
                            oninput="setVolume(this.value)"
                            style="width: 150px; cursor: pointer;"
                        >
                        <button id="mute-btn" onclick="toggleMute()" style="padding: 6px 12px; font-size: 14px; cursor: pointer; background: #666; color: white; border: none; border-radius: 4px;">
                            üîä
                        </button>
                    </div>

                    <div class="code-block" style="margin-top: 20px;">
                        <code>// Embed with hidden controls: &controls=0
// &lt;iframe src="...?v=author/id&mode=iframe&controls=0"&gt;

// Setup: Get iframe and create helper
const iframe = document.getElementById('player');
const send = (cmd, data = {}) =>
  iframe.contentWindow.postMessage({ type: cmd, ...data }, '*');

// PLAYBACK CONTROLS
send('toggle-play');        // Toggle play/pause
send('play');               // Start playing
send('pause');              // Pause video
send('toggleFullscreen');   // Toggle fullscreen

// VOLUME CONTROLS
send('setVolume', { volume: 0.5 });  // Set to 50%
send('volumeUp', { step: 0.1 });     // +10%
send('volumeDown', { step: 0.2 });   // -20%
send('toggleMute');                   // Toggle mute
send('mute');                         // Mute
send('unmute');                       // Unmute

// SEEKING
send('seek', { time: 30 });           // Go to 30s
send('seekForward', { seconds: 15 }); // +15s
send('seekBackward', { seconds: 5 }); // -5s
send('seekForward');                  // +10s (default)
send('seekBackward');                 // -10s (default)

// GET CURRENT STATE
send('getState');  // Triggers '3speak-state' event

// LISTEN FOR EVENTS
window.addEventListener('message', (e) => {
  const { type, currentTime, duration,
          paused, muted, volume } = e.data;

  if (type === '3speak-timeupdate') {
    console.log(`${currentTime}s / ${duration}s`);
  }
  if (type === '3speak-play') console.log('Playing');
  if (type === '3speak-pause') console.log('Paused');
  if (type === '3speak-ended') console.log('Ended');
});</code>
                    </div>
                </div>
            </div>

            <h3 style="margin-top: 30px;">Available Commands</h3>
            <div style="background: #1a1a1a; border-radius: 8px; padding: 20px; margin: 20px 0; overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; color: #ccc;">
                    <tr style="border-bottom: 1px solid #444;">
                        <th style="padding: 12px; text-align: left; color: #4a9eff;">Command</th>
                        <th style="padding: 12px; text-align: left; color: #4a9eff;">Parameters</th>
                        <th style="padding: 12px; text-align: left; color: #4a9eff;">Description</th>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px;"><code style="color: #4af;">toggle-play</code></td>
                        <td style="padding: 12px;">-</td>
                        <td style="padding: 12px;">Toggle play/pause</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px; background: #252525;"><code style="color: #4af;">play</code></td>
                        <td style="padding: 12px; background: #252525;">-</td>
                        <td style="padding: 12px; background: #252525;">Start playback</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px;"><code style="color: #4af;">pause</code></td>
                        <td style="padding: 12px;">-</td>
                        <td style="padding: 12px;">Pause playback</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px;"><code style="color: #4af;">toggleFullscreen</code></td>
                        <td style="padding: 12px;">-</td>
                        <td style="padding: 12px;">Toggle fullscreen mode</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px; background: #252525;"><code style="color: #4af;">setVolume</code></td>
                        <td style="padding: 12px; background: #252525;"><code>{ volume: 0-1 }</code></td>
                        <td style="padding: 12px; background: #252525;">Set volume level (0 to 1)</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px;"><code style="color: #4af;">volumeUp</code></td>
                        <td style="padding: 12px;"><code>{ step: 0.1 }</code></td>
                        <td style="padding: 12px;">Increase volume by step (default 0.1)</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px; background: #252525;"><code style="color: #4af;">volumeDown</code></td>
                        <td style="padding: 12px; background: #252525;"><code>{ step: 0.1 }</code></td>
                        <td style="padding: 12px; background: #252525;">Decrease volume by step (default 0.1)</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px;"><code style="color: #4af;">mute</code></td>
                        <td style="padding: 12px;">-</td>
                        <td style="padding: 12px;">Mute audio</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px; background: #252525;"><code style="color: #4af;">unmute</code></td>
                        <td style="padding: 12px; background: #252525;">-</td>
                        <td style="padding: 12px; background: #252525;">Unmute audio</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px;"><code style="color: #4af;">seek</code></td>
                        <td style="padding: 12px;"><code>{ time: seconds }</code></td>
                        <td style="padding: 12px;">Seek to specific time in seconds</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px; background: #252525;"><code style="color: #4af;">seekForward</code></td>
                        <td style="padding: 12px; background: #252525;"><code>{ seconds: 10 }</code></td>
                        <td style="padding: 12px; background: #252525;">Skip forward (default 10 seconds)</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px;"><code style="color: #4af;">seekBackward</code></td>
                        <td style="padding: 12px;"><code>{ seconds: 10 }</code></td>
                        <td style="padding: 12px;">Skip backward (default 10 seconds)</td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; background: #252525;"><code style="color: #4af;">getState</code></td>
                        <td style="padding: 12px; background: #252525;">-</td>
                        <td style="padding: 12px; background: #252525;">Request current player state (triggers 3speak-state event)</td>
                    </tr>
                </table>
            </div>

            <h3 style="margin-top: 30px;">Events from Player</h3>
            <p style="color: #ccc; margin-bottom: 15px;">The player sends these events to the parent window via postMessage:</p>
            <div style="background: #1a1a1a; border-radius: 8px; padding: 20px; margin: 20px 0; overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; color: #ccc;">
                    <tr style="border-bottom: 1px solid #444;">
                        <th style="padding: 12px; text-align: left; color: #4a9eff;">Event</th>
                        <th style="padding: 12px; text-align: left; color: #4a9eff;">Data</th>
                        <th style="padding: 12px; text-align: left; color: #4a9eff;">Description</th>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px;"><code style="color: #4af;">3speak-timeupdate</code></td>
                        <td style="padding: 12px;"><code>currentTime, duration, paused, muted, volume</code></td>
                        <td style="padding: 12px;">Sent ~4x per second during playback</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px; background: #252525;"><code style="color: #4af;">3speak-durationchange</code></td>
                        <td style="padding: 12px; background: #252525;"><code>duration</code></td>
                        <td style="padding: 12px; background: #252525;">Sent when video duration becomes available</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px;"><code style="color: #4af;">3speak-play</code></td>
                        <td style="padding: 12px;">-</td>
                        <td style="padding: 12px;">Sent when playback starts</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px; background: #252525;"><code style="color: #4af;">3speak-pause</code></td>
                        <td style="padding: 12px; background: #252525;">-</td>
                        <td style="padding: 12px; background: #252525;">Sent when playback pauses</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #333;">
                        <td style="padding: 12px;"><code style="color: #4af;">3speak-ended</code></td>
                        <td style="padding: 12px;">-</td>
                        <td style="padding: 12px;">Sent when video ends</td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; background: #252525;"><code style="color: #4af;">3speak-state</code></td>
                        <td style="padding: 12px; background: #252525;"><code>currentTime, duration, paused, muted, volume, ended</code></td>
                        <td style="padding: 12px; background: #252525;">Response to getState command</td>
                    </tr>
                </table>
            </div>
        </div>

        <!-- For Developers -->
        <div class="demo-section">
            <h2>9. üõ†Ô∏è For Frontend Developers</h2>
            <p>Simple JavaScript to auto-embed 3speak URLs:</p>
            
            <div class="code-block">
                <code>// Detect and convert 3speak URLs to iframes
const videoRegex = /https:\/\/(play\.)?3speak\.tv\/(watch|embed)\?v=([^&\s]+)/g;

const content = "Check out: https://play.3speak.tv/watch?v=meno/1czchhmr";

const embeddedContent = content.replace(videoRegex, (match, subdomain, route, videoId) => {
  return `&lt;iframe src="https://play.3speak.tv/${route}?v=${videoId}&mode=iframe" 
          width="854" height="480" frameborder="0" allowfullscreen&gt;&lt;/iframe&gt;`;
});</code>
            </div>

            <div style="background: #1a3a5c; border-radius: 8px; padding: 20px; margin: 20px 0; border-left: 4px solid #4a9eff;">
                <strong style="color: #87ceeb;">üí° Implementation Checklist for 3speak Devs:</strong><br>
                ‚Ä¢ ‚úÖ <strong>NO database changes needed!</strong> Player reads dimensions from HLS manifest<br>
                ‚Ä¢ ‚úÖ <strong>ONE TIME setup:</strong> Add message event listener to your app (see examples above)<br>
                ‚Ä¢ ‚úÖ <strong>Embed iframe:</strong> Just use author/permlink - player auto-detects everything<br>
                ‚Ä¢ ‚úÖ <strong>Listen for message:</strong> Player sends <code>3speak-player-ready</code> with video dimensions<br>
                ‚Ä¢ ‚úÖ <strong>Adjust iframe:</strong> Use 800px height for vertical, 450px for horizontal<br>
                ‚Ä¢ ‚úÖ <strong>Style container:</strong> Use max-width 450px for vertical, 800px for horizontal<br>
                ‚Ä¢ ‚úÖ <strong>Test videos:</strong> <code>vempromundo/hkh2vzzf</code> (vertical), <code>meno/1czchhmr</code> (horizontal)<br>
                ‚Ä¢ ‚úÖ <strong>Embed mode:</strong> Always include <code>&mode=iframe</code> for clean display
            </div>

            <div style="background: #2d5a27; border-radius: 8px; padding: 20px; margin: 20px 0; border-left: 4px solid #4caf50;">
                <strong style="color: #a5d6a7;">üéâ COMPLETE: Production-Ready Embed System!</strong><br>
                The player now offers the perfect integration experience:<br>
                ‚Ä¢ <strong>Zero database changes</strong> - Works with existing schema ‚úÖ<br>
                ‚Ä¢ <strong>Automatic detection</strong> - Player reads HLS metadata ‚úÖ<br>
                ‚Ä¢ <strong>PostMessage API</strong> - Clean communication with frontend ‚úÖ<br>
                ‚Ä¢ <strong>JW Player quality</strong> - 20 lines CSS, perfect video display ‚úÖ<br>
                ‚Ä¢ <strong>Copy-paste ready</strong> - Examples for vanilla JS, React, Next.js ‚úÖ<br>
                <strong>Frontend devs can integrate in under 10 minutes!</strong>
            </div>
        </div>
    </div>

    <script>
        let videoDuration = 0;
        let isSeeking = false;
        let isPlaying = false;
        let isMuted = false;

        function sendCommand(command, data = {}) {
            const iframe = document.getElementById('controlled-player');
            iframe.contentWindow.postMessage({ type: command, ...data }, '*');
        }

        function togglePlayPause() {
            sendCommand('toggle-play');
        }

        function updatePlayPauseButton() {
            const btn = document.getElementById('play-pause-btn');
            btn.innerHTML = isPlaying ? '‚è∏ Pause' : '‚ñ∂ Play';
        }

        function toggleMute() {
            sendCommand('toggleMute');
        }

        function updateMuteButton() {
            const btn = document.getElementById('mute-btn');
            btn.innerHTML = isMuted ? 'üîá' : 'üîä';
        }

        function setVolume(value) {
            const volume = value / 100;
            document.getElementById('volume-display').textContent = value + '%';
            sendCommand('setVolume', { volume: volume });
        }

        function formatTime(seconds) {
            if (!seconds || isNaN(seconds)) return '0:00';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function updateProgress(percent) {
            document.getElementById('progress-fill').style.width = percent + '%';
            document.getElementById('progress-handle').style.left = percent + '%';
        }

        // Progress bar drag handling
        const progressBar = document.getElementById('progress-bar');
        const progressHandle = document.getElementById('progress-handle');

        function seekFromEvent(e) {
            const rect = progressBar.getBoundingClientRect();
            const percent = Math.max(0, Math.min(100, ((e.clientX - rect.left) / rect.width) * 100));
            updateProgress(percent);
            if (videoDuration > 0) {
                const time = (percent / 100) * videoDuration;
                sendCommand('seek', { time: time });
            }
        }

        progressBar.addEventListener('mousedown', (e) => {
            isSeeking = true;
            progressHandle.style.cursor = 'grabbing';
            seekFromEvent(e);

            const onMove = (e) => seekFromEvent(e);
            const onUp = () => {
                isSeeking = false;
                progressHandle.style.cursor = 'grab';
                document.removeEventListener('mousemove', onMove);
                document.removeEventListener('mouseup', onUp);
            };

            document.addEventListener('mousemove', onMove);
            document.addEventListener('mouseup', onUp);
        });

        // Listen for messages from the player
        window.addEventListener('message', function(event) {
            const data = event.data;
            if (!data || !data.type) return;

            switch (data.type) {
                case '3speak-timeupdate':
                    if (!isSeeking && data.duration > 0) {
                        videoDuration = data.duration;
                        const progress = (data.currentTime / data.duration) * 100;
                        updateProgress(progress);
                        document.getElementById('time-current').textContent = formatTime(data.currentTime);
                        document.getElementById('time-duration').textContent = formatTime(data.duration);
                        if (isPlaying !== !data.paused) {
                            isPlaying = !data.paused;
                            updatePlayPauseButton();
                        }
                        if (isMuted !== data.muted) {
                            isMuted = data.muted;
                            updateMuteButton();
                        }
                    }
                    break;
                case '3speak-durationchange':
                    videoDuration = data.duration;
                    document.getElementById('time-duration').textContent = formatTime(data.duration);
                    break;
                case '3speak-play':
                    isPlaying = true;
                    updatePlayPauseButton();
                    break;
                case '3speak-pause':
                case '3speak-ended':
                    isPlaying = false;
                    updatePlayPauseButton();
                    break;
            }
        });
    </script>
</body>
</html>
